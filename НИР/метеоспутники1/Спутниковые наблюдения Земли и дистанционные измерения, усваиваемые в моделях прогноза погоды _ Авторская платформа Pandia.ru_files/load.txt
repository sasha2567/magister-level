(function(a,b){if(typeof a.topadvert!=="undefined"){return}var c=(function(){var f={};var e={};var d={};d.registerClass=function(h,g){if(e.hasOwnProperty(h)){return}e[h]=g};d.getClass=function(g){if(!f.hasOwnProperty(g)){if(e.hasOwnProperty(g)){f[g]=(e[g])()}}return f[g]};return d})();c.registerClass("Object",function(){var d=function(){};(function(){var e=false;var f=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;d.extend=function(l){var i=this.prototype;e=true;var h=new this();e=false;for(var g in l){if(!l.hasOwnProperty(g)){continue}var j=l[g];if(typeof l[g]==="function"&&typeof i[g]==="function"&&f.test(l[g])){j=(function(m,n){return function(){var p=this._super;this._super=i[m];var o=n.apply(this,arguments);this._super=p;return o}})(g,l[g])}h[g]=j}function k(){if(!e&&this.init){this.init.apply(this,arguments)}}k.prototype=h;k.constructor=k;k.extend=arguments.callee;return k}})();return d});c.registerClass("Utils",function(){var d=function(j){return toString.call(j)==="[object Array]"};var h=function(k){for(var j in k){return false}return true};var f=function(k){if(!k||toString.call(k)!=="[object Object]"||k.nodeType||k.setInterval){return false}if(k.constructor&&!hasOwnProperty.call(k,"constructor")&&!hasOwnProperty.call(k.constructor.prototype,"isPrototypeOf")){return false}var j;for(j in k){}return j===b||hasOwnProperty.call(k,j)};var i=function(n,m){var j={};for(var l in n){if(n.hasOwnProperty(l)){j[l]=n[l]}}for(var l in m){if(m.hasOwnProperty(l)){j[l]=m[l]}}return j};var g=function(n,k,q){if(!n.length||n.length<k){return n}var r="";var l=n.split(q);var o=0;var p=q.length;for(var m=0;m<l.length;m++){var j=l[m];if(!r){r+=j;continue}if(r.length+p+j.length<k){r+=q+j}else{break}}return r};var e=c.getClass("Object");e.extendObject=i;e.getRandomToken=function(){var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghijklmnopqrstuvwxyz";var j=n.length;var m="";for(var l=0;l<10;++l){var k=Math.floor(Math.random()*j);if(k>=j){k=j-1}m+=n.charAt(k)}return m};e.strip=function(j){return j.replace(/^\s+/,"").replace(/\s+$/,"")};e.getHead=function(){return document.getElementsByTagName("head")[0]||document.documentElement};e.getReferer=function(){var j=document.referrer;if(j==null){j=""}if(j.length>255){j=j.substring(0,255)}return j};e.sendRequest=function(k,l){var j=document.createElement("script");if(l==null){l="topadvertScript"+e.getRandomToken()}j.type="text/javascript";j.setAttribute("src",k);j.setAttribute("id",l);j.setAttribute("charset","utf-8");j.setAttribute("defer","defer");j.setAttribute("async","async");e.getHead().appendChild(j)};e.sendImgRequest=function(k){var j=document.createElement("img");j.setAttribute("src",k)};e.createBaseUrl=function(j){return"http"+(location.protocol=="http:"?"":"s")+"://"+j};e.softCutStringBySeparator=g;return e});c.registerClass("Adblock",function(){var f=[];var i=null;var e=[null,null];var d=false;var h=e.length;var j=function(){h--;if(h==0){i=e[0]&&!e[1];for(var k=0;k<f.length;k++){(function(l){setTimeout(function(){l(i)},0)})(f[k])}f=null}};var g=c.getClass("Object").extend({});g.isEnabledGet=function(l){if(i!=null){setTimeout(function(){l(i)},0);return}f.push(l);if(d){return}d=true;for(var k=0;k<e.length;k++){(function(n){var m=new Image();m.onload=function(){e[n]=true;j()};m.onerror=function(){e[n]=false;j()};m.src=c.getClass("Utils").createBaseUrl("loader.adrelayer.com")+"/px.gif?ch="+(n+1)+"&rnd="+c.getClass("Utils").getRandomToken()})(k)}};return g});c.registerClass("Request.Const",function(){var d=c.getClass("Object").extend({});d.ENCODE_JSCOMP="jscomp";d.ENCODE_URI_COMPONENT="encodeuricomponent";d.MAX_PARAM_LENGTH=255;return d});c.registerClass("Encoding.Abstract.EncoderFactory",function(){var d=c.getClass("Object").extend({createSimpleEncoder:function(){},createBufferedEncoder:function(){}});return d});c.registerClass("Encoding.Abstract.SimpleEncoder",function(){var d=c.getClass("Object").extend({encode:function(e){},decode:function(e){}});return d});c.registerClass("Encoding.JSCompression.SimpleEncoder",function(){var f="_";var d="~";var e=c.getClass("Encoding.Abstract.SimpleEncoder").extend({init:function(){this._currentLang="en";this._firstLang=null;var g={};var h={};var l={all:{singleChars:"0123456789- ",singleMaps:"0123456789-+",doubleChars:"~_!@#$%^&*()+=`{}[]\\|:;\"'?/,\u2116<>.\u00ab\u00bb",doubleMaps:"Xx1234567890prVbBlLWIdDQqvwzNGgfkK"},en:{singleChars:"abvgdeqzijklmnoprstufhcyxwABVGDEQZIJKLMNOPRSTUFHCYXW",singleMaps:"abvgdeqzijklmnoprstufhcyxwABVGDEQZIJKLMNOPRSTUFHCYXW",doubleChars:"",doubleMaps:""},ru:{singleChars:"\u0430\u0431\u0432\u0433\u0434\u0435\u0436\u0437\u0438\u0439\u043a\u043b\u043c\u043d\u043e\u043f\u0440\u0441\u0442\u0443\u0444\u0445\u0446\u044b\u044d\u044e\u0410\u0411\u0412\u0413\u0414\u0415\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\u0425\u0426\u042b\u042d\u042e",singleMaps:"abvgdeqzijklmnoprstufhcyxwABVGDEQZIJKLMNOPRSTUFHCYXW",doubleChars:"\u0451\u0447\u0448\u0449\u044a\u044c\u044f\u0401\u0427\u0428\u0429\u042a\u042c\u042f",doubleMaps:"ecshtmaECSHTMA"}};for(var k in l){if(!l.hasOwnProperty(k)){continue}var j=function(q,m,n){var r=q.split("");var t=m.split("");for(var p=0;p<r.length;++p){var o=r[p];var s=n?d+t[p]:t[p];g[o]=[s,k];if(h[k]==null){h[k]={}}h[k][s]=o}};var i=l[k];j(i.singleChars,i.singleMaps,false);j(i.doubleChars,i.doubleMaps,true)}this._encode=function(s,t){if(t!=null){this._currentLang=t}var r=s.split("");var u="";for(var q=0;q<r.length;++q){var n=g[r[q]];if(n==null){n=g[" "]}var p="";var m=n[1];if(m!==this._currentLang&&m!=="all"){this._currentLang=m;p=f+m+f}var o=p+n[0];u+=o}this._firstLang=(u.charAt(0)===f)?u.substring(1,2):"en";return u};this._decode=function(t){var m="";var r="en";for(var p=0;p<t.length;++p){var q=t.charAt(p);if(q===f){var o=t.indexOf(q,p+1);if(o<0){return null}var s=t.substring(p+1,o);if(h[s]==null){return null}r=s;p+=o-p;continue}if(q===d){p+=1;if(p===t.length){return null}q+=t.charAt(p)}var n=h.all[q];if(n==null){n=h[r][q]}if(n==null){return null}m+=n}return m}},encodeWithPrevLang:function(h,g){if(g==null){g="en"}if(typeof h==="boolean"){h=h?"1":"0"}if(typeof h==="number"){h+=""}if(typeof h==="string"){return this._encode(h,g)}return""},encode:function(g){return this.encodeWithPrevLang(g)},decode:function(g){return this._decode(g)},getFirstLanguage:function(){return this._firstLang},getLastLanguage:function(){return this._currentLang}});e.getPageChar=function(){return f};return e});c.registerClass("Encoding.Abstract.BufferedEncoder",function(){var d=c.getClass("Object").extend({init:function(e){},addString:function(f,e){},getResult:function(){}});return d});c.registerClass("Encoding.JSCompression.BufferedEncoder",function(){var e=c.getClass("Encoding.JSCompression.SimpleEncoder").getPageChar();var d=c.getClass("Encoding.Abstract.BufferedEncoder").extend({init:function(f){this._result="";this._firstLanguage=null;this._lastLanguage="en";this._encoder=new (c.getClass("Encoding.JSCompression.SimpleEncoder"))()},addString:function(h,f){var g=this._encoder.encodeWithPrevLang(h,this._lastLanguage);if(f!=null){if(g.length>f){return -1}}this._result+=g;this._lastLanguage=this._encoder.getLastLanguage();if(this._firstLanguage==null){this._firstLanguage=this._encoder.getFirstLanguage()}return g.length},getResult:function(){var f=this._result;if(f===""){return""}if(f.charAt(0)!==e){f=e+this._firstLanguage+e+f}return f}});return d});c.registerClass("Encoding.JSCompression.EncoderFactory",function(){var d=c.getClass("Encoding.Abstract.EncoderFactory").extend({createSimpleEncoder:function(){var e=new (c.getClass("Encoding.JSCompression.SimpleEncoder"))();return e},createBufferedEncoder:function(){var e=new (c.getClass("Encoding.JSCompression.BufferedEncoder"))();return e}});return d});c.registerClass("Encoding.URIComponent.SimpleEncoder",function(){var d=c.getClass("Encoding.Abstract.SimpleEncoder").extend({encode:function(e){return encodeURIComponent(e)},decode:function(e){return decodeURIComponent(e)}});return d});c.registerClass("Encoding.URIComponent.BufferedEncoder",function(){var d=c.getClass("Encoding.Abstract.BufferedEncoder").extend({init:function(){this._result="";this._encoder=new (c.getClass("Encoding.URIComponent.SimpleEncoder"))()},addString:function(g,e){var f=this._encoder.encode(g);if(e!=null){if(f.length>e){return -1}}this._result+=f;return f.length},getResult:function(e){return this._result}});return d});c.registerClass("Encoding.URIComponent.EncoderFactory",function(){var d=c.getClass("Encoding.Abstract.EncoderFactory").extend({createSimpleEncoder:function(){var e=new (c.getClass("Encoding.URIComponent.SimpleEncoder"))();return e},createBufferedEncoder:function(){var e=new (c.getClass("Encoding.URIComponent.BufferedEncoder"))();return e}});return d});c.registerClass("Request.Path",function(){var f=c.getClass("Request.Const").ENCODE_JSCOMP;var d=c.getClass("Request.Const").ENCODE_URI_COMPONENT;var e=c.getClass("Object").extend({init:function(j,g){this._fullPath=j;this._prefix="?";var h=2048;this._freeLength=h-j.length;var i;if(g===f){i=new (c.getClass("Encoding.JSCompression.EncoderFactory"))()}else{i=new (c.getClass("Encoding.URIComponent.EncoderFactory"))()}this._encoder=i.createSimpleEncoder();this._encoderFactory=i;this._getParamLength=function(k,l){return k.length+l.length+2};this._addParam=function(l,m){var k=this._getParamLength(l,m);if(k>this._freeLength){return false}this._fullPath+=this._prefix+l+"="+m;this._prefix="&";this._freeLength-=k;return true};this.addParam("rnd",c.getClass("Utils").getRandomToken());this.addParam("v","305f5964ee");this.addParam("encode",g);this.addParam("post_message",a.postMessage!=null?"1":"0")},addParam:function(h,i){var g=this._encoder.encode(i);return this._addParam(h,g)},getFullPath:function(){return this._fullPath}});return e});c.registerClass("Browser",function(){var e;var d=c.getClass("Object").extend({init:function(){this._loaded=false;this._onLoadFunctions=[];var f=this;var g=function(){if(f._loaded){return}f._loaded=true;var h=f._onLoadFunctions.length;for(var j=0;j<h;++j){f._onLoadFunctions[j]()}};(function(){if(document.readyState==="complete"){return g()}if(document.addEventListener){var i=function(){document.removeEventListener("DOMContentLoaded",i,false);g()};document.addEventListener("DOMContentLoaded",i,false);a.addEventListener("load",g,false)}if(document.attachEvent){var h=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",h);g()}};document.attachEvent("onreadystatechange",h);a.attachEvent("onload",g)}})()},loaded:function(){return this._loaded},onLoad:function(g){this._loaded?g():this._onLoadFunctions.push(g)},isAsync:function(){return a.opera?false:true},isIE:function(){return false}});d.getInstance=function(){if(e==null){e=new d()}return e};return d});c.registerClass("Request.Request",function(){var f=c.getClass("Request.Const").ENCODE_JSCOMP;var d=c.getClass("Request.Const").ENCODE_URI_COMPONENT;var e=c.getClass("Object").extend({init:function(o){if(typeof a.topadvertCallbacks==="undefined"){a.topadvertCallbacks={}}var i={url:c.getClass("Utils").createBaseUrl("feed.adrelayer.com")+"/feed",pack:false,timeout:0,onError:null,callback:null,context:false,jsCode:"",data:null,isAdblockEnabled:null};i=c.getClass("Utils").extendObject(i,o);var m=c.getClass("Utils").getRandomToken();var n='topadvertCallbacks["'+m+'"]';var h="topadvertCallback"+m;var g=c.getClass("Request.Const").MAX_PARAM_LENGTH;var j=(function(){var p=i.pack?f:d;var s=new (c.getClass("Request.Path"))(i.url,p);s.addParam("is_adblock_enabled",i.isAdblockEnabled);var r=function(v){var w=document.title?document.title.toLowerCase():"";return c.getClass("Utils").softCutStringBySeparator(w,g," ")};if(i.data!=null){for(var q in i.data){if(!i.data.hasOwnProperty(q)){continue}var u=i.data[q];s.addParam(q,u)}}if(i.callback){s.addParam("callback",'topadvertCallbacks["'+m+'"]')}s.addParam("js_code",i.jsCode);s.addParam("context_title",r(g));var t=c.getClass("Utils").getReferer();if(t){s.addParam("referer",t)}fullPath=s.getFullPath();return fullPath})();var k=function(p){topadvertCallbacks[m]=p};var l;k(function(p){clearTimeout(l);i.callback(p);delete topadvertCallbacks[m]});this._cancel=function(){k(function(q){});var p=document.getElementById(h);c.getClass("Utils").getHead().removeChild(p);if(i.onError&&typeof i.onError==="function"){i.onError()}};this._send=function(){c.getClass("Utils").sendRequest(j,h);var p=this;if(i.timeout>0){l=setTimeout(p._cancel,i.timeout)}}},send:function(){var g=c.getClass("Browser").getInstance();if(g.isAsync()){this._send()}else{var h=this;g.onLoad(function(){h._send()})}},cancel:function(){this._cancel()}});return e});c.registerClass("Counters.Openstat",function(){var e=false;var d=c.getClass("Object").extend({});d.count=function(){if(e){return}var f=c.getClass("Utils").createBaseUrl("openstat.net")+"/cnt?cid=2169165&rn="+Math.random();c.getClass("Utils").sendImgRequest(f);e=true};return d});c.registerClass("Counters.Quantcast",function(){var e=false;var d=c.getClass("Object").extend({});d.count=function(){if(e){return}var f;var g;var k;var j;var h=[];h.push({qacct:"p-WCeJmPS5E7cR4"});if(!f){var f={qcdst:function(){if(f.qctzoff(0)!=f.qctzoff(6)){return 1}return 0},qctzoff:function(l){var p=new Date(2000,l,1,0,0,0,0);var n=p.toGMTString();var o=new Date(n.substring(0,n.lastIndexOf(" ")-1));return p-o},qceuc:function(l){if(typeof(encodeURIComponent)=="function"){return encodeURIComponent(l)}else{return escape(l)}},qcrnd:function(){return Math.round(Math.random()*2147483647)},qcgc:function(r){var o="";var q=document.cookie;if(!q){return o}var p=q.indexOf(r+"=");var l=p+r.length+1;if(p>-1){var m=q.indexOf(";",l);if(m<0){m=q.length}o=q.substring(l,m)}return o},qcdomain:function(){var o=document.domain;if(o.substring(0,4)=="www."){o=o.substring(4,o.length)}var m=o.split(".");var l=m.length;if(l<3){return o}var n=m[l-1];if(n.length<3){return o}o=m[l-2]+"."+m[l-1];return o},qhash2:function(n,m){for(var l=0;l<m.length;l++){n^=m.charCodeAt(l);n+=(n<<1)+(n<<4)+(n<<7)+(n<<8)+(n<<24)}return n},qhash:function(n){var m=2166136261,l=3386659096;var p=f.qhash2(m,n);var o=f.qhash2(l,n);return(Math.round(Math.abs(p*o)/65536)).toString(16)},sd:["4dcfa7079941","127fdf7967f31","588ab9292a3f","32f92b0727e5","22f9aa38dfd3","a4abfe8f3e04","18b66bc1325c","958e70ea2f28","bdbf0cb4bbb","65118a0d557","40a1d9db1864","18ae3d985046","3b26460f55d"],qcsc:function(){var r="";var t=f.qcdomain();if(f.qad==1){return";fpan=u;fpa="}var l=f.qhash(t);for(var q=0;q<f.sd.length;q++){if(f.sd[q]==l){return";fpan=u;fpa="}}var p=document;var m=f.qcgc("__qca");if(m.length>0){r+=";fpan=0;fpa="+m}else{var o=new Date();var n=new Date(o.getTime()+33955200000);m="P0-"+f.qcrnd()+"-"+o.getTime();p.cookie="__qca="+m+"; expires="+n.toGMTString()+"; path=/; domain="+t;m=f.qcgc("__qca");if(m.length>0){r+=";fpan=1;fpa="+m}else{r+=";fpan=u;fpa="}}return r},qcdc:function(l){document.cookie=l+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/; domain="+f.qcdomain()},qpxload:function(l){if(l&&typeof(l.width)=="number"&&l.width==3){f.qcdc("__qca")}},qcdnt:function(){var m=false;if(typeof(a.external)!=="undefined"&&a.external!==null){var l=a.external;m=(typeof l.InPrivateFilteringEnabled==="function"&&l.InPrivateFilteringEnabled()===true)}return(m||navigator.doNotTrack==="1"||navigator.doNotTrack==="yes"||navigator.msDoNotTrack==="1")},qcp:function(u,r){var o="",l=null;uh=null;var t="webpage",q="load";if(r!=null){for(var m in r){if(typeof(m)!="string"){continue}if(typeof(r[m])!="string"){continue}if(m=="uid"||m=="uh"){if(f.qcdnt()===false){uh=f.qhash(r[m])}delete r[m];continue}if(m=="qacct"){l=r[m];continue}o+=";"+m+u+"="+f.qceuc(r[m]);if(m=="media"){t=r[m]}if(m=="event"){q=r[m]}}}if(typeof l!="string"){if((typeof g=="undefined")||(g.length==0)){return""}l=g}if(typeof uh==="string"){r.uh=uh;o+=";uh"+u+"="+f.qceuc(uh)}if(t=="webpage"&&q=="load"){for(var n=0;n<f.qpixelsent.length;n++){if(f.qpixelsent[n]==l){return""}}f.qpixelsent.push(l)}if(t=="ad"){f.qad=1}o=";a"+u+"="+l+o;return o},qcesc:function(l){return l.replace(/\./g,"%2E").replace(/,/g,"%2C")},qcd:function(l){return(typeof(l)!="undefined"&&l!=null)},qcogl:function(){var n=document.getElementsByTagName("meta");var t="";for(var r=0;r<n.length;r++){if(t.length>=1000){return t}if(f.qcd(n[r])&&f.qcd(n[r].attributes)&&f.qcd(n[r].attributes.property)&&f.qcd(n[r].attributes.property.value)&&f.qcd(n[r].content)){var s=n[r].attributes.property.value;var u=n[r].content;if(s.length>3&&s.substring(0,3)=="og:"){if(t.length>0){t+=","}var q=(u.length>80)?80:u.length;t+=f.qcesc(s.substring(3,s.length))+"."+f.qcesc(u.substring(0,q))}}}return f.qceuc(t)},firepixel:function(n){var z=(typeof(encodeURIComponent)=="function")?"n":"s";var w=f.qcrnd();var y="",m="",p="",s="",t="",B="u",D="1";var o=0;f.qad=0;if(typeof f.qpixelsent=="undefined"){f.qpixelsent=new Array()}if(typeof n!="undefined"&&n!=null){f.qopts=n;for(var x in f.qopts){if(typeof(f.qopts[x])=="string"){m=f.qcp("",f.qopts);break}else{if(typeof(f.qopts[x])=="object"&&f.qopts[x]!=null){++o;m+=f.qcp("."+o,f.qopts[x])}}}}else{if(typeof g=="string"){m=f.qcp("",null)}}if(m.length==0){return}var v=(navigator.cookieEnabled)?"1":"0";if(typeof navigator.javaEnabled!="undefined"){B=(navigator.javaEnabled())?"1":"0"}if(typeof k!="undefined"&&k!=null){p=";m="+f.qceuc(k);k=null}if(self.screen){y=screen.width+"x"+screen.height+"x"+screen.colorDepth}var A=new Date();var E=f.qcdst();var l="http";if(a.location.protocol!="http:"){l+="s"}l+="://pixel.quantserve.com";var u=f.qcsc();if(a.location&&a.location.href){s=f.qceuc(a.location.href)}if(a.document&&a.document.referrer){t=f.qceuc(a.document.referrer)}if(self==top){D="0"}var q=f.qcogl();var C=new Image();C.alt="";C.src=l+"/pixel;r="+w+m+u+";ns="+D+";ce="+v+";je="+B+";sr="+y+";enc="+z+";dst="+E+";et="+A.getTime()+";tzo="+A.getTimezoneOffset()+p+";ref="+t+";url="+s+";ogl="+q;C.onload=function(){f.qpxload(C)}},quantserve:function(){if(typeof h=="undefined"){h=[]}if(typeof j!="undefined"&&j!=null){f.firepixel(j);j=null}else{if(!h.length&&typeof g!="undefined"){f.firepixel(null)}}if(!f.evts){for(var l in h){f.firepixel(h[l])}h={push:function(){var m=arguments;for(var n=0;n<m.length;n++){f.firepixel(m[n])}}};f.evts=1}}}}function i(){f.quantserve()}i();e=true};return d});c.registerClass("Processors.Constant",function(){var e=c.getClass("Object").extend({});var n=["book_author","book_isbn","book_name","book_publisher"];var m=["tech_accessory","tech_model","tech_type","tech_vendor"];var k=n.concat(m);var g=["alt_text","feed_id","hit_feed_id","hit_pattern_id","load_event","pattern_id","search"].concat(k);var f={};for(var j=0;j<g.length;j++){f[g[j]]=null}var d=["adblock_container_id","downloadable","format","is_partner","limit","query","sort","sub_id","title"];var h=d.concat(g);var l={};for(var j=0;j<h.length;j++){l[h[j]]=null}e.getTextareaParamMapToSendToServer=function(){return f};e.getTopicParamList=function(){return k};e.getParamNamesForParseFromTextareaMap=function(){return l};return e});c.registerClass("URLParams",function(){var e;var d=c.getClass("Object").extend({init:function(){this._encoder=new (c.getClass("Encoding.JSCompression.SimpleEncoder"))()},get:function(){var f={};var g=a.location.href;var m=/[\?\&]topadvert_params=(.*?)(\&|$)/.exec(g);if(m!=null){var q=this._encoder.decode(m[1]);var o=q.split("&");for(var k=0;k<o.length;++k){var n=/^(.*?)=(.*?)$/.exec(o[k]);if(n!=null){f[RegExp.$1]=this._encoder.decode(RegExp.$2)}}}var j={pattern_id:null,common_params:{},components_params:{}};for(var r in f){if(f.hasOwnProperty(r)){if(r==="pattern_id"){j.pattern_id=f[r]}else{var m=/^(.*?):(.*?)$/.exec(r);if(m!=null){var p=RegExp.$1;var l=RegExp.$2;var h=j.components_params[p];if(h==null){h={};j.components_params[p]=h}h[l]=f[r]}else{j.common_params[r]=f[r]}}}}return j},set:function(m){var p;var l=this;var j=function(s,t){return s+"="+l._encoder.encode(t)};var g=m.url;var h=m.pattern_id;var k=m.common_params;var q=m.components_params;var f=[];f.push(j("pattern_id",h));if(k!=null){for(p in k){if(k.hasOwnProperty(p)){f.push(j(p,k[p]))}}}if(q!=null){for(var n in q){if(q.hasOwnProperty(n)){var i=q[n];for(p in i){if(i.hasOwnProperty(p)){f.push(j(n+":"+p,i[p]))}}}}}var o=f.join("&");var r=/\?/.test(g)?"&":"?";g=g+r+"topadvert_params="+this._encoder.encode(o);return g}});d.getInstance=function(){if(!e){e=new d()}return e};return d});c.registerClass("LoadJSAPI",function(){var e;var d=c.getClass("Object").extend({getClass:function(){return c.getClass("Object")},getURLParams:function(){return c.getClass("URLParams").getInstance()}});d.getInstance=function(){if(!e){e=new d()}return e};return d});c.registerClass("Request.Sender",function(){var d=c.getClass("Object").extend({init:function(e){this._send=function(g,h,f){c.getClass("Adblock").isEnabledGet(function(i){var k=c.getClass("Utils").extendObject(e,{data:g,callback:h,context:true,onError:f,isAdblockEnabled:i});var j=new (c.getClass("Request.Request"))(k);j.send()})}},send:function(i,e,h){c.getClass("Counters.Openstat").count();c.getClass("Counters.Quantcast").count();var g=c.getClass("Processors.Constant").getTextareaParamMapToSendToServer();var j={};for(var f in i){if(g.hasOwnProperty(f)){j[f]=i[f]}}var l=function(k){k.process(e,c.getClass("LoadJSAPI").getInstance())};this._send(j,l,h)}});return d});c.registerClass("Processors.AbstractProcessor",function(){var d=c.getClass("Object").extend({init:function(e){var g={url:c.getClass("Utils").createBaseUrl("feed.adrelayer.com")+"/feed",pack:true,codeType:""};var f=c.getClass("Utils").extendObject(g,e);this._sender=new (c.getClass("Request.Sender"))({url:f.url,pack:f.pack,timeout:f.timeout,jsCode:f.codeType})},_getElementsToProcess:function(){return[]},_processSingleElement:function(e){},process:function(){var f=this._getElementsToProcess();var e=f.length;for(var g=0;g<e;++g){this._processSingleElement(f[g])}}});return d});c.registerClass("Parser",function(){var d=c.getClass("Object").extend({init:function(){var e;var f;var h;var i=c.getClass("Processors.Constant").getParamNamesForParseFromTextareaMap();var g=function(j){return j.replace(/^\s+|\s+$/g,"")};this._parse=function(x){var q={};var w;var m="";var r=/((\w+):(\s*(.|\n)*?\s*))(?=(\w+:|$))/g;var A=function(){if(w!=null){if(w=="search"){m=m.replace("%title%","");m=m.replace("%referer%","")}m=m.replace(/^\s*/,"");m=m.replace(/\s*$/,"");var k="_clean_"+w;if(typeof(this[k])==="function"){m=this[k](m)}q[w]=m;m=""}};while(r.exec(x)){var t=RegExp.$2;var y=RegExp.$3;var v=RegExp.$1;if(i.hasOwnProperty(t)){A();w=t;m+=y}else{m+=v}}A();var z=c.getClass("Processors.Constant").getTopicParamList();var p=function(F){var H={};var G=/\s*&&\s*/;for(var C=0;C<z.length;C++){var B=z[C];var D=new RegExp("\\$\\["+B+"\\[([^\\]]*)\\]\\]","g");var k;while(k=D.exec(F)){var E=k[1].replace(G," ");if(!H.hasOwnProperty(B)){H[B]=[]}H[B].push(E)}}return H};if(q.hasOwnProperty("query")){var l=p(q.query);for(var s in l){if(l.hasOwnProperty(s)){var n=[l[s]];if(q.hasOwnProperty(s)){n.push(q[s])}q[s]=n.join("||")}}}var j=c.getClass("Request.Const").MAX_PARAM_LENGTH;for(var o in q){if(!q.hasOwnProperty(o)){continue}var u=q[o];if(w!="search"){u=c.getClass("Utils").softCutStringBySeparator(u,j,"||")}u=c.getClass("Utils").softCutStringBySeparator(u,j," ");q[o]=u}return q}},parse:function(f){var h=f;if(f.tagName){var e=f;h=e.value}var g=this._parse(h);return g},parseMultiple:function(j){var h=j.length;var f=[];for(var g=0;g<h;++g){var k=this.parse(j[g]);f.push(k)}return f}});return d});c.registerClass("Processors.Textarea.AbstractProcessor",function(){var d=c.getClass("Processors.AbstractProcessor").extend({init:function(e){this._super(e);this._parser=new (c.getClass("Parser"))();this._processedElements=[];this._textareaName="to_be_redefined_in_child_class"},_onRequestTimeout:function(e){},_getAllElements:function(){return document.getElementsByName(this._textareaName)},_getElementsToProcess:function(){var m=this._getAllElements();var e=m.length;var f=[];for(var k=0;k<e;++k){var l=m[k];var h=false;for(var g=0;g<this._processedElements.length;++g){if(this._processedElements[g]===l){h=true;break}}if(!h){f.push(l);this._processedElements.push(l)}}return f},_processSingleElement:function(g){var h=this._parser.parse(g);var e={getType:function(){return"div"},getLoadEvent:function(){return"page_load"},getTextarea:function(){return g},getCodeElement:function(){return g},getDivId:function(){return null}};var f=this;this._sender.send(h,e,function(){f._onRequestTimeout(g)})}});return d});c.registerClass("Processors.Textarea.Async.Processor",function(){var d=c.getClass("Processors.Textarea.AbstractProcessor").extend({init:function(){this._super({codeType:"textarea_async"});this._textareaName="topadvert_request_async"}});return d});c.registerClass("Processors.Textarea.Sync.Processor",function(){var d=c.getClass("Processors.Textarea.AbstractProcessor").extend({init:function(){this._super({codeType:"textarea_sync"});this._textareaName="topadvert_request_sync"}});return d});c.registerClass("Processors.Textarea.Old.Processor",function(){var d=c.getClass("Processors.Textarea.AbstractProcessor").extend({init:function(){this._super({codeType:"textarea_old"});this._textareaName="topadvert_request"}});return d});c.registerClass("Processors.Textarea.Utils",function(){var d=c.getClass("Object").extend({});d.getEventPosition=function(h){var f=0;var i=0;if(h.pageX!=null&&h.pageY!=null){f=parseInt(h.pageX);i=parseInt(h.pageY)}else{var g=d.getPageScroll();f=parseInt(h.clientX)+g.left;i=parseInt(h.clientY)+g.top}return{x:f,y:i}};d.getPageScroll=function(){var e=0;var f=0;if(a.pageXOffset!=null&&a.pageYOffset!=null){e=parseInt(a.pageXOffset);f=parseInt(a.pageYOffset)}else{if(document.body!=null&&(document.body.scrollLeft||document.body.scrollTop)){e=parseInt(document.body.scrollLeft);f=parseInt(document.body.scrollTop)}else{if(document.documentElement!=null&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){e=parseInt(document.documentElement.scrollLeft);f=parseInt(document.documentElement.scrollTop)}}}return{left:e,top:f}};return d});c.registerClass("Processors.LoadEvent.MouseAction.Block",function(){var e={currentActiveIndex:1,openActiveIndex:0,blocks:[]};var d=c.getClass("Object").extend({init:function(){this.openHandler=null;this.closeHandler=null;this.activeIndex=null;this._isActive=false;e.blocks.push(this)},updateIndex:function(){this.activeIndex=e.currentActiveIndex++},isActual:function(){return this.activeIndex>=e.openActiveIndex},isActive:function(){return this._isActive},setOpenHandler:function(f){this.openHandler=f},setCloseHandler:function(f){this.closeHandler=f},activate:function(g,h){if(g){this.updateIndex()}e.openActiveIndex=this.activeIndex;for(var f=0;f<e.blocks.length;++f){e.blocks[f].deactivate()}if(this.openHandler){this.openHandler(h)}this._isActive=true},deactivate:function(){if(this.closeHandler){this.closeHandler()}this._isActive=false}});return d});c.registerClass("Processors.Textarea.Event.Old.Processor",function(){var d=c.getClass("Processors.Textarea.Utils").getEventPosition;var e=c.getClass("Processors.Textarea.AbstractProcessor").extend({init:function(){this._super({codeType:"textarea_event_old"});this._blocks={};var h=this;a.topadvert_internal_open_div=function(m,l){var k=h._prepareCoords(l);h._open_div(m,k)};a.topadvert_internal_close_div=function(k){h._close_div(k)};a.topadvert_open_div=function(m,l){var k=d(l);h._open_div(m,k)};a.topadvert_close_div=function(k){h._close_div(k)};if(typeof(topadvert_div_map)!="undefined"){for(var j in topadvert_div_map){if(!topadvert_div_map.hasOwnProperty(j)){continue}var i=topadvert_div_map[j];var f=this._prepareCoords(i);var g=document.getElementById(j);this._processSingleElement(g,f)}}},_processSingleElement:function(f,g){this._processedElements.push(f);var i=new (c.getClass("Processors.LoadEvent.MouseAction.Block"))();var h={codeElement:f,coords:g,hasMissedCloseEvent:false,bmBlock:i,openActionHandler:null,closeActionHandler:null};h.bmBlock.updateIndex();this._blocks[f.id]=h;this._sendRequest(h)},_sendRequest:function(h){if(h.requestIsSent){return}var f=this;var g=f._parser.parse(h.codeElement);f._sender.send(g,{getType:function(){return"old_event"},getLoadEvent:function(){return"old_mouse_action"},getTextarea:function(){return h.codeElement},getCodeElement:function(){return h.codeElement},getEventCoords:function(){return h.coords},hasMissedCloseEvent:function(){return h.hasMissedCloseEvent},delMissedCloseEvent:function(){h.hasMissedCloseEvent=false},setOpenActionHandler:function(i){h.openActionHandler=i},setCloseActionHandler:function(i){h.closeActionHandler=i},setOpenHandler:function(i){h.bmBlock.openHandler=i},setCloseHandler:function(i){h.bmBlock.closeHandler=i},isActual:function(){return h.bmBlock.isActual()},activate:function(i,j){h.bmBlock.activate(i,j)},deactivate:function(){h.bmBlock.deactivate()},isActive:function(){return h.bmBlock.isActive()}});h.requestIsSent=true},_prepareCoords:function(g){var f=(g==null)?null:{x:g[0],y:g[1]};return f},_open_div:function(l,f){var j=document.getElementById(l);var g=false;for(var h=0;h<this._processedElements.length;++h){if(this._processedElements[h]===j){g=true}}if(!g){this._processSingleElement(j,f)}else{var k=this._blocks[j.id];if(k!=null){if(k.openActionHandler){k.openActionHandler(f)}}}},_close_div:function(g){var f=this._blocks[g];if(f!=null){if(f.closeActionHandler){f.hasMissedCloseEvent=false;f.closeActionHandler()}else{f.hasMissedCloseEvent=true}}}});return e});c.registerClass("Processors.LoadEvent.MouseAction.Processor",function(){var e=c.getClass("Object").extend({init:function(f){this._sender=f.sender;this._elem=f.elem;this._data=f.data;this._event=f.event},process:function(){var g=this;var f=d(this._elem);if(!f){return}var i=new (c.getClass("Processors.LoadEvent.MouseAction.Block"))();var h={bmBlock:i,data:this._data,codeElement:this._elem,link:f,linkIsMouseOver:false,linkMouseOverCoords:null,linkOnClickCoords:null,linkOnClickHandler:null,linkOnMouseOverHandler:null,linkOnMouseOutHandler:null};h.link.onclick=function(j){j=j?j:a.event;h.linkOnClickCoords=c.getClass("Processors.Textarea.Utils").getEventPosition(j);h.bmBlock.updateIndex();if(h.linkOnClickHandler){h.linkOnClickHandler(h.linkOnClickCoords)}return false};h.link.onmouseover=function(j){j=j?j:a.event;h.linkIsMouseOver=true;h.linkMouseOverCoords=c.getClass("Processors.Textarea.Utils").getEventPosition(j);h.bmBlock.updateIndex();g._realSend(h);if(h.linkOnMouseOverHandler){h.linkOnMouseOverHandler(h.linkMouseOverCoords)}return false};h.link.onmouseout=function(j){j=j?j:a.event;h.linkIsMouseOver=false;if(h.linkOnMouseOutHandler){h.linkOnMouseOutHandler()}return false}},_realSend:function(g){if(g.requestIsSent){return}var f=this;f._sender.send(g.data,{getType:function(){return"event"},getLoadEvent:function(){return"mouse_action"},getEvent:function(){return f._event},getTextarea:function(){return g.codeElement},getCodeElement:function(){return g.codeElement},getLink:function(){return g.link},getLinkIsMouseOver:function(){return g.linkIsMouseOver},getLinkMouseOverCoords:function(){return g.linkMouseOverCoords},getLinkOnClickCoords:function(){return g.linkOnClickCoords},setLinkOnClickHandler:function(h){g.linkOnClickHandler=h},setLinkOnMouseOverHandler:function(h){g.linkOnMouseOverHandler=h},setLinkOnMouseOutHandler:function(h){g.linkOnMouseOutHandler=h},setOpenHandler:function(h){g.bmBlock.setOpenHandler(h)},setCloseHandler:function(h){g.bmBlock.setCloseHandler(h)},isActual:function(){return g.bmBlock.isActual()},activate:function(h,i){g.bmBlock.activate(h,i)},deactivate:function(){g.bmBlock.deactivate()},isActive:function(){return g.bmBlock.isActive()}});g.requestIsSent=true}});var d=function(h){var g=null;var f=0;while(f++<10&&h!=null){if(h.nextSibling){h=h.nextSibling}else{h=h.parentNode;continue}if(h!=null&&h.nodeType===1){g=h;break}}return g};return e});c.registerClass("Processors.Textarea.Event.AbstractProcessor",function(){var d=c.getClass("Processors.Textarea.Utils").getEventPosition;var e=c.getClass("Processors.Textarea.AbstractProcessor").extend({init:function(f){this._super(f);this._event=null;this._textareaName=null},_processSingleElement:function(f){var g=this._parser.parse(f);new (c.getClass("Processors.LoadEvent.MouseAction.Processor"))({sender:this._sender,elem:f,data:g,event:this._event}).process()}});return e});c.registerClass("Processors.Textarea.Event.Onclick.Processor",function(){var d=c.getClass("Processors.Textarea.Event.AbstractProcessor").extend({init:function(){this._super({codeType:"textarea_event_onclick"});this._textareaName="topadvert_request_onclick";this._event="click"}});return d});c.registerClass("Processors.Textarea.Event.Onmouseover.Processor",function(){var d=c.getClass("Processors.Textarea.Event.AbstractProcessor").extend({init:function(){this._super({codeType:"textarea_event_onmouseover"});this._textareaName="topadvert_request_onmouseover";this._event="mouseover"}});return d});c.registerClass("Processors.LoadEvent.PageLoad.Processor",function(){var d=c.getClass("Object").extend({init:function(e){this._sender=e.sender;this._elem=e.elem;this._data=e.data;this._divId=e.div_id},process:function(){var f=this;var e={getType:function(){return"div"},getLoadEvent:function(){return"page_load"},getTextarea:function(){return f._elem},getCodeElement:function(){return f._elem},getDivId:function(){return f._divId}};this._sender.send(this._data,e,function(){f._onRequestTimeout(f._elem)})}});return d});c.registerClass("Processors.Script.Processor",function(){var d=c.getClass("Processors.AbstractProcessor").extend({init:function(e){this._super({codeType:"script"});this._processedElements=[]},_getAllElements:function(){var e=[];var h=document.getElementsByTagName("script");for(var g=0;g<h.length;++g){var f=h[g];if(f&&f.type==="text/topadvert"){e.push(f)}}return e},_getElementsToProcess:function(){var m=this._getAllElements();var e=m.length;var f=[];for(var k=0;k<e;++k){var l=m[k];var h=false;for(var g=0;g<this._processedElements.length;++g){if(this._processedElements[g]===l){h=true;break}}if(!h){f.push(l);this._processedElements.push(l)}}return f},_processSingleElement:function(f){var g=new (c.getClass("Parser"))().parse(f.innerHTML);if(g.load_event==="page_load"){var e=this;c.getClass("Adblock").isEnabledGet(function(h){var i=null;if(g.adblock_container_id!=null&&g.adblock_container_id.length){if(!h){return}if(g.adblock_container_id!="this"){i=g.adblock_container_id}}new (c.getClass("Processors.LoadEvent.PageLoad.Processor"))({sender:e._sender,elem:f,data:g,div_id:i}).process()})}else{if(g.load_event==="mouse_action"){new (c.getClass("Processors.LoadEvent.MouseAction.Processor"))({sender:this._sender,elem:f,data:g}).process()}}}});return d});c.registerClass("Loader",function(){var d=c.getClass("Object").extend({init:function(){var j=new (c.getClass("Processors.Textarea.Async.Processor"))();var g=new (c.getClass("Processors.Textarea.Sync.Processor"))();var e=new (c.getClass("Processors.Textarea.Old.Processor"))();var n=new (c.getClass("Processors.Textarea.Event.Old.Processor"))();var h=new (c.getClass("Processors.Textarea.Event.Onclick.Processor"))();var m=new (c.getClass("Processors.Textarea.Event.Onmouseover.Processor"))();var k=new (c.getClass("Processors.Script.Processor"))();var l=[j,g,e,n,h,m,k];var i=c.getClass("Browser").getInstance();var f;this._load=function(){c.getClass("Adblock").isEnabledGet(function(p){});var o=function(){var p=l.length;for(var q=0;q<p;++q){var r=l[q];r.process()}};o();f=setInterval(o,100);i.onLoad(function(){clearInterval(f);f=setInterval(o,500)})}},load:function(){this._load()}});return d});(function(){var d=new (c.getClass("Loader"))();d.load();a.topadvert={init:function(){}}})()})(window);